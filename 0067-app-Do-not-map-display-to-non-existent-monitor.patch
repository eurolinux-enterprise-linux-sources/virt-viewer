From a2aa19350c66faeb81cb2911a07a8eff55df2794 Mon Sep 17 00:00:00 2001
From: Pavel Grunt <pgrunt@redhat.com>
Date: Tue, 20 Oct 2015 14:42:45 +0200
Subject: [PATCH] app: Do not map display to non-existent monitor

(cherry picked from commit 1f2ef0e9de4133c375df3b20993c93d66fa7f172)
---
 src/virt-viewer-app.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/virt-viewer-app.c b/src/virt-viewer-app.c
index 1638669..af344c7 100644
--- a/src/virt-viewer-app.c
+++ b/src/virt-viewer-app.c
@@ -349,6 +349,10 @@ gint virt_viewer_app_get_initial_monitor_for_display(VirtViewerApp* self, gint d
             monitor = -1;
         }
     }
+    if (monitor >= get_n_client_monitors()) {
+        g_debug("monitor for display %d does not exist", display);
+        monitor = -1;
+    }
 
     return monitor;
 }
@@ -358,7 +362,7 @@ app_window_try_fullscreen(VirtViewerApp *self G_GNUC_UNUSED,
                           VirtViewerWindow *win, gint nth)
 {
     gint monitor = virt_viewer_app_get_initial_monitor_for_display(self, nth);
-    if (monitor == -1 || monitor >= get_n_client_monitors()) {
+    if (monitor == -1) {
         g_debug("skipping fullscreen for display %d", nth);
         return;
     }
